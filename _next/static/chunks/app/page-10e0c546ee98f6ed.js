(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2469:(t,e,a)=>{"use strict";a.d(e,{M7:()=>G,lm:()=>v,jS:()=>C,default:()=>S});var r=a(5155),n=a(2115),l=a(6754);let s=(t,e)=>{let a=t.reduce((t,e)=>(t.push(e/360*(2*Math.PI)),t),[]);return l.pie().startAngle(a[0]).endAngle(a[1]).value(t=>t.prisonCount).sort((t,a)=>l[e](t.pieOrder,a.pieOrder))},i={id:"",type:"",municipality:"",region:"Friuli Venezia Giulia",suicides:0,attemptedSuicides:0,selfHarm:0,regulatoryRooms:0,nonRegulatoryRooms:0,totalPrisoners:0,overcrowdingAbsolute:0,overcrowdingPercent:0,expectedPolice:0,realPolice:0,differenceInPoliceNumbers:0,top30SelfHarm:!1,top30Suicides:!1},c=(t,e)=>{let a=l.group(t,t=>t.region),r=Array.from(a.keys()).reduce((t,r,n)=>{0===n&&(t={top:[],bottom:[]});let s=e.find(t=>t.region===r),c=a.get(r);return s&&c&&(c=c.sort((t,e)=>l["top"===s.circle?"descending":"ascending"](t.overcrowdingPercent,e.overcrowdingPercent)),"Friuli Venezia Giulia"===r&&c.unshift(i),t[s.circle].push({name:s.shortName,fullName:s.region,pieOrder:s.northToSouthOrder,prisonCount:c.length,data:c})),t},{}),n=s([7,200],"ascending")(r.top);return{pieTopData:n,pieBottomData:s([194,380],"descending")(r.bottom),maxPrisons:l.max(Array.from(a),t=>t[1].length)}},o=(t,e)=>{let a=t.exec(e);return a&&a.length>1?a[1]:""},p=(t,e)=>{let a=l.arc().outerRadius(e-G/2).innerRadius(e-1-G/2)(t)||"",r=o(/(^.+?)L/,a);if(""!==r&&(r=r.replace(/,/g," "),t.startAngle>=Math.PI/2&&t.startAngle<=1.5*Math.PI)){let t=o(/0 0 1 (.*?)$/,r),e=o(/M(.*?)A/,r);return"M"+t+"A"+o(/A(.*?)0 0 1/,r)+"0 0 0 "+e}return a},d=(t,e)=>{let{value:a,lastX:r,lastY:n}=t,s={x:(r+-40)/2,y:n+.5},i=t.path.split(",").slice(0,-2),c=[String(r),String(n),"L".concat(r),"".concat(n," Q").concat(s.x),String(s.y),"".concat(-40),String(n)],o=l.linkHorizontal().x(t=>t.x).y(t=>t.y)({source:{x:-40,y:+n},target:{x:0,y:e}}),p=0===a?"M".concat(r-10,",").concat(n):i.concat(c).join(",");return"".concat(p).concat(o?o.replace(/M/g,"L"):"").concat(0===a||1===a?"L".concat(420,",").concat(e):"")},h=(t,e,a)=>{let r={startAngle:l.min(t,t=>t.startAngle)||0,endAngle:l.max(t,t=>t.endAngle)||0},n=Array.from({length:11}).map((t,e)=>e/10).reduce((t,n)=>{let s=e(n)||0,i=l.arc().innerRadius(s).outerRadius(s),c=v.darkGrey;1===n&&"top"===a&&(c="transparent"),(.5===n||0===n&&"top"===a||(1===n||0===n)&&"bottom"===a)&&(c="white");let o=i(r)||"";return t.push({path:o,value:n,fill:c}),t},[]);if("top"===a)return n;let s=n.reduce((t,e)=>{let{0:a,1:r}=e.path.split(",").slice(-2);if(e.lastX=+a,e.lastY=+r.replace(/Z/g,""),e.extentIndex=+(e.value<=.5),t.push(e),.5===e.value){let a={...JSON.parse(JSON.stringify(e)),value:+e.value,lastX:+e.lastX,lastY:+e.lastY,extentIndex:0};t.push(a)}return t},[]),i=l.extent(s,t=>t.lastY);return s.reduce((t,e)=>{let a=i[e.extentIndex]||0;return e.path=d(e,a),t.push(e),t},[])},u=()=>{let t="".concat(-2,",").concat(-2),e="".concat(2,",").concat(-2),a="".concat(-2,",").concat(2),r="".concat(2,",").concat(2),n="M".concat(t,"L").concat(e,"L").concat(r,"L").concat(a,"Z"),s=1.4*Math.PI/3,i=-(.7*Math.PI),c=l.arc().padAngle(.2).cornerRadius(.5).innerRadius(4).outerRadius(5);return{squarePath:n,circularArcs:Array.from({length:3},(t,e)=>e+1).reduce((t,e,a)=>{let r=a*s,n=c({startAngle:i+r,endAngle:i+r+s});return n&&t.push(n),t},[])}},g=t=>{let{prison:e,lineAngle:a,prisonAngle:r,stroke:n,dashArray:s,arcScale:i}=t,c=i(e.overcrowdingPercent/100),o=l.lineRadial().angle(t=>t[0]).radius(t=>t[1]),p=o([[a,i.range()[0]],[r,c]])||"",d=p.split("L")[1].split(",").reduce((t,e)=>(t.push(+e),t),[]);return{linePath:p,endCoord:d,angleAsDegrees:a/(2*Math.PI)*360,stroke:n,dashArray:s,data:e}},f=(t,e,a,r)=>{let n=t=>0===t?e:1===t?e-a/3.5:e+a/3.5,l=[];if(t.suicides>0&&l.push(g({prison:t,lineAngle:e,prisonAngle:e,stroke:v.red,dashArray:"4,4",arcScale:r})),t.top30Suicides){let a=n(l.length);l.push(g({prison:t,lineAngle:a,prisonAngle:e,stroke:"white",dashArray:"4,4",arcScale:r}))}if(t.top30SelfHarm){let a=n(l.length);l.push(g({prison:t,lineAngle:a,prisonAngle:e,stroke:"white",dashArray:"2,2",arcScale:r}))}return 0===l.length&&l.push(g({prison:t,lineAngle:e,prisonAngle:e,stroke:"white",dashArray:"",arcScale:r})),l.map((t,e)=>t.showSquare=0===e),l.reverse()},m=(t,e)=>{t.select(".legendTitle").attr("font-size",12).attr("fill","white").text("How to read");let{0:a,1:r}=e.domain(),n=[1,5,r],s=t.select(".circlesGroup").selectAll(".legendCircleGroup").data(n).join(t=>{let e=t.append("g").attr("class","legendCircleGroup");return e.append("circle").attr("class","legendCircle"),e.append("text").attr("class","legendCircleLabel"),e});s.attr("transform","translate(".concat(1+e(r),",",15,")")),s.select(".legendCircle").attr("r",t=>e(t)).attr("fill","transparent").attr("stroke","white").attr("stroke-width",.5).attr("cy",t=>2*e(r)-e(t)),s.select(".legendCircleLabel").attr("text-anchor","middle").attr("fill","white").attr("font-size",4).attr("y",t=>-1+2*e(r)-2*e(t)).text(t=>t);let i=[{line:!0,y:-e(r)/2,x0:e(r)/2,x1:6*e(r),fontSize:6,textAnchor:"left",wrapWidth:65,dy:-7,label:"Circle dimensions: total number of prisons in the region"},{line:!0,y:e(r)-e(a),x0:0,x1:2*e(r),fontSize:6,textAnchor:"left",wrapWidth:60,dy:-7,label:"Total number of suicides in the region's prisons"},{line:!1,y:e(r)-e(a),x0:0,x1:0,fontSize:6,textAnchor:"middle",wrapWidth:0,dy:0,label:"X"}],c=t.select(".circleLabelsGroup").selectAll(".legendCircleLabelGroup").data(i).join(t=>{let e=t.append("g").attr("class","legendCircleLabelGroup");return e.append("line").attr("class","legendCircleLabelLine"),e.append("text").attr("class","legendCircleLabelText"),e});c.attr("transform",t=>"translate(".concat(1+e(r),",").concat(15+e(r)+t.y,")")),c.select(".legendCircleLabelLine").filter(t=>t.line).attr("x1",t=>t.x0).attr("x2",t=>t.x1-3).attr("stroke","black").attr("stroke-width",.5),c.select(".legendCircleLabelText").attr("transform",t=>"translate(".concat(t.x1,",").concat(t.dy,")")).attr("fill","white").style("font-size",t=>t.fontSize).attr("text-anchor",t=>t.textAnchor).attr("dominant-baseline","middle").attr("dy",t=>t.dy).text(t=>t.label),l.selectAll(".legendCircleLabelText").filter(t=>t.line).each((t,e,a)=>{x(l.select(a[e]),t.wrapWidth)});let o=[{stroke:v.red,strokeDashArray:"4,4",label:"Prisons with one or more suicides",x:40,length:125},{stroke:"white",strokeDashArray:"4,4",label:"Top 30 prisons with attempted suicides",x:55,length:80},{stroke:"white",strokeDashArray:"2,2",label:"Top 30 prisons with self-harm cases",x:45,length:55},{stroke:"white",strokeDashArray:"",label:"No special cases to mention",x:25,length:45}],p=t.select(".linesGroup").selectAll(".linesDataGroup").data(o).join(t=>{let e=t.append("g").attr("class","linesDataGroup");return e.append("text").attr("class","lineDataLabel"),e.append("line").attr("class","lineDataLine"),e});p.attr("transform",(t,e)=>"translate(0,".concat(70+18*e,")")),p.select(".lineDataLabel").attr("fill","white").style("font-size",6).attr("dominant-baseline","middle").text(t=>t.label),p.select(".lineDataLine").attr("stroke",t=>t.stroke).attr("stroke-dasharray",t=>t.strokeDashArray).attr("stroke-width",1).attr("x1",t=>t.x).attr("x2",t=>t.x+t.length).attr("y1",7.5).attr("y2",7.5),l.selectAll(".lineDataLabel").each((t,e,a)=>{x(l.select(a[e]),53)}),t.select(".policeTitle").attr("font-size",6).attr("fill","white").attr("text-anchor","middle").attr("transform","translate(".concat(210,",",75,")")).text("Shortage of police staff").call(x,40);let{squarePath:d,circularArcs:h}=u();t.select(".policeSquare").attr("fill","white").attr("d",d).attr("transform","translate(".concat(210,",",65,")"));let g=t.select(".policePathsGroup").selectAll(".legendPathsGroup").data(h).join(t=>{let e=t.append("g").attr("class","legendPathsGroup");return e.append("path").attr("class","policeStaffCurve"),e});g.attr("transform","translate(".concat(210,",",65,")")),g.select(".policeStaffCurve").attr("d",t=>t).attr("fill","white");let f=t.select(".policeLinesGroup").selectAll(".legendPoliceLinesGroup").data([{path:"M-7,0L-15,0L-15,-15",x:-15,title:"Low",label:"<15 ppl"},{path:"M0,-6L0,-35",x:0,title:"Medium",label:"16-30ppl"},{path:"M7,0L15,0L15,-15",x:15,title:"High",label:"31> ppl"}]).join(t=>{let e=t.append("g").attr("class","legendPoliceLinesGroup");return e.append("text").attr("class","policeLineLabelValue"),e.append("text").attr("class","policeLineLabelTitle"),e.append("path").attr("class","policeLinePath"),e});f.attr("transform","translate(".concat(210,",",65,")")),f.select(".policeLinePath").attr("fill","none").attr("stroke","black").attr("stroke-width",.75).attr("d",t=>t.path),f.select(".policeLineLabelValue").attr("fill","white").attr("font-size",6).attr("text-anchor","middle").attr("x",t=>t.x).attr("y",t=>-18-20*(0===t.x)).text(t=>t.label),f.select(".policeLineLabelTitle").attr("fill","white").attr("font-size",6).attr("text-anchor","middle").attr("text-decoration","underline").attr("x",t=>t.x).attr("y",t=>-26-20*(0===t.x)).text(t=>t.title)},x=(t,e)=>{t.each(function(){l.select(this).selectAll("tspan").remove();let t=l.select(this).text().split(/\s+/).reverse(),a="",r=[],n=0,s=l.select(this).text(null).append("tspan").attr("x",0).attr("y",0).attr("dy","".concat(0,"em"));for(;a=t.pop()||"";){r.push(a),s.text(r.join(" "));let t=s.node()||void 0;t&&t.getComputedTextLength()>e&&(r.pop(),s.text(r.join(" ")),r=[a],s=l.select(this).append("tspan").attr("x",0).attr("y",0).attr("dy",1.025*++n+0+"em").text(a))}})},y=(t,e,a)=>{let r="https://www.linkedin.com/posts/valeriabeccari_dataviz-datibenecomune-informationdesign-activity-7292590337795981312-3fer?utm_source=share&utm_medium=member_desktop&rcm=ACoAACARFfUBpGLAsNXbOfTx0YgTrs0fy3krcwA";t.select(".valeriaLink").attr("cursor","pointer").attr("text-anchor","end").attr("font-size",12).attr("font-weight",500).attr("transform","translate(".concat(e-10,",20)")).attr("fill","white").html("Data Visualisation &#169; Valeria Beccari").on("click",()=>{window.open(r,"_blank")}),t.select(".chartTitle").attr("cursor","pointer").attr("font-size",30).attr("font-weight",500).attr("transform","translate(0,45)").attr("fill","white").text("The dramatic conditions of Italian prisons, focus 2024").on("click",()=>{window.open(r,"_blank")}).call(x,.55*e),t.select(".chartInfo1").attr("pointer-events","none").attr("font-size",10).attr("transform","translate(0,110)").attr("fill","white").text("In 2024, the Italian prison system faced a severe crisis due to overcrowding. Out of 188 penitentiary institutions, 138 exceeded their official capacity, highlighting increasing pressure on both facilities and staff. The analysis focuses on 100 of these 138 overcrowded prisons in the twenty regions of Italy, starting from the North, providing a representative overview of the most critical issues: suicides, attempted suicides and self-harm cases are not uncommon and are often strictly connected to overcrowding. The severe shortage of prison staff is another crucial problem: the disparity between the planned number of correctional officers and the actual workforce is often striking, leading to increased stress, safety concerns, and management difficulties within the facilities.").call(x,.6*e),t.select(".chartInfo2").attr("pointer-events","none").attr("font-size",10).attr("transform","translate(0,220)").attr("fill","white").text("The project Liberiamoli tutti! for the campaign #DatiBeneComune has provided valuable data for this analysis, revealing the significant gap between the official capacity and the actual number of inmates in many facilities. Can we change the narrative when we are aware of the issues?").call(x,.6*e),t.select(".prisonDeathTitle").attr("pointer-events","none").attr("font-size",10).attr("font-weight",600).attr("transform","translate(".concat(.4*e,",").concat(a-85,")")).attr("fill","white").text("Dying in prison").call(x,60),t.select(".criticalitiesTitle").attr("pointer-events","none").attr("font-size",10).attr("font-weight",600).attr("transform","translate(".concat(.4*e,",").concat(.6*a,")")).attr("fill","white").text("Criticalities on the rise").call(x,60),t.select(".criticalitiesExtra").attr("pointer-events","none").attr("font-size",8).attr("transform","translate(".concat(.4*e+80,",").concat(.6*a-3,")")).attr("fill","white").text("The year 2024 (second line) saw an increase in many issues compared to the previous year. The graph shows the increasing percentage, as well as the absolute number, of the examined criticalities.").call(x,280)},L=(t,e,a,r)=>{if(0===a.length)return;let{region:n,municipality:s}=a[0],i=r[n]&&r[n]>0?r[n]:void 0,c={suicides:"Suicides (top 100)",overcrowdingPercent:"Overcrowding Percent",selfHarm:"Self harm incidents",totalPrisoners:"Total Prisoners",differenceInPoliceNumbers:"Police manpower gap",attemptedSuicides:"Attempted Suicides"},o="",p=["<table>"];i&&p.push('<tr><td style="font-weight: bold;">Suicides (all)</td><td style="text-align: right">'.concat(l.format(",")(i),"</td></tr>")),"region"===e?(o="<strong>".concat(n.toUpperCase(),"</strong><br><br>"),p.push('<tr><td style="font-weight: bold;">Prisons</td><td style="text-align: right">'.concat(a.length,"</td></tr>")),["suicides","attemptedSuicides","selfHarm","differenceInPoliceNumbers","totalPrisoners"].forEach(t=>{let e=l.sum(a,e=>+e[t]);p.push('<tr><td style="font-weight: bold;">'.concat(c[t],'</td><td style="text-align: right">').concat(l.format(",")(e),"</td></tr>"))})):(o="<strong>".concat(s.toUpperCase(),"</strong><br><br>"),p.push('<tr><td style="font-weight: bold;">Region</td><td style="text-align: right">'.concat(n,"</td></tr>")),["suicides","attemptedSuicides","selfHarm","overcrowdingPercent","differenceInPoliceNumbers","totalPrisoners"].forEach(t=>{let e=+a[0][t];e&&p.push('<tr><td style="font-weight: bold;">'.concat(c[t],'</td><td style="text-align: right">').concat(l.format(",")(e),"</td></tr>"))})),p.push("</table>"),o+=p.join(""),l.select(".prisonsTooltip").html(o).style("visibility","visible").style("top","".concat(t.pageY-10,"px")).style("left","".concat(t.pageX+10,"px"))},b=()=>{l.select(".prisonsTooltip").style("visibility","hidden")},A=t=>{let{svg:e,dimensions:a,pieData:r,pieClass:n,transformX:s,transformY:i,prisonCircleScale:c,suicidesPerRegion:o}=t,{width:d,height:g,circleRadius:m}=a,x=2*m,y=C.top+x-G-(g-C.bottom-x+G)-2*G-7.2,A=m-G-y,w=m-G,k=l.scaleLinear().domain([0,1]).range("top"===n?[A,w]:[w,A]),S=k(1)-k(.9),j=l.arc().outerRadius(m).innerRadius(m-G),P=l.arc().innerRadius(m-y-G-2.5).outerRadius(m-y-G+2.5),N="top"===n?.19:l.min(r,t=>t.startAngle)||0;e.select(".".concat(n,"StartRegionLine")).attr("stroke","white").attr("transform","translate(".concat(s,",").concat(i,")")).attr("d",P({startAngle:N,endAngle:N}));let T=e.select(".arcGroup").selectAll(".pieGroup".concat(n)).data(r).join(t=>{let e=t.append("g").attr("class","pieGroup".concat(n));return e.append("path").attr("class","backgroundArc"),e.append("path").attr("class","labelArc"),e.append("text").attr("class","labelText").append("textPath").attr("class","labelTextPath"),e.append("path").attr("class","regionLine"),e.append("circle").attr("class","prisonCircleItem prisonCountCircle"),e.append("text").attr("class","prisonCircleItem prisonCountCircleLabel"),e.append("g").attr("class","prisonsGroup"),e});T.attr("transform","translate(".concat(s,",").concat(i,")")),T.select(".regionLine").attr("stroke","white").attr("d",t=>P({startAngle:t.startAngle,endAngle:t.startAngle})),T.select(".prisonCountCircle").attr("fill",t=>t.data.pieOrder%2==0?v.lightGrey:v.darkGrey).attr("r",t=>o[t.data.name]?c(o[t.data.name]):0).attr("cursor","pointer").on("mousemove",(t,e)=>{L(t,"region",e.data.data,o)}).on("mouseout",()=>{b()}),T.select(".prisonCountCircleLabel").attr("pointer-events","none").attr("font-size",8).attr("dy",1).attr("text-anchor","middle").attr("fill",t=>t.data.pieOrder%2==0?v.darkGrey:v.lightGrey).attr("dominant-baseline","middle").text(t=>o[t.data.name]&&o[t.data.name]>0?o[t.data.name]:""),l.selectAll(".prisonCircleItem").attr("transform",t=>{let e=t.startAngle+(t.endAngle-t.startAngle)/2,a=l.arc().innerRadius(m-y-G-25).outerRadius(m-y-G-25).centroid({startAngle:e,endAngle:e});return"translate(".concat(a[0],",").concat(a[1],")")}),T.select(".backgroundArc").attr("fill",t=>t.data.pieOrder%2==0?v.lightGrey:v.darkGrey).attr("d",j).attr("cursor","pointer").on("mousemove",(t,e)=>{L(t,"region",e.data.data,o)}).on("mouseout",()=>{b()}),T.select(".labelArc").attr("id",(t,e)=>"labelPath".concat(n).concat(e)).attr("fill","transparent").attr("d",t=>p(t,m)),T.select(".labelText").attr("pointer-events","none").attr("dy",.5).attr("fill",t=>t.data.pieOrder%2==0?v.darkGrey:v.lightGrey).attr("dominant-baseline","middle"),T.select(".labelTextPath").attr("startOffset",t=>t.startAngle>=Math.PI/2&&t.startAngle<=1.5*Math.PI?"50%":"25%").attr("font-size",6).attr("text-anchor","middle").attr("xlink:href",(t,e)=>"#labelPath".concat(n).concat(e)).text(t=>t.data.name.toUpperCase()),e.select(".scaleBackgroundRect").attr("fill",v.background).attr("x",d-m+12).attr("y",C.top).attr("width",15).attr("height",y+2*G);let z=h(r,k,n),D=e.select(".scaleGroup").selectAll(".percentageArcGroup".concat(n)).data(z).join(t=>{let e=t.append("g").attr("class","percentageArcGroup".concat(n));return e.append("path").attr("class","scaleArc"),e});D.attr("transform","translate(".concat(s,",").concat(i,")")),D.select(".scaleArc").attr("stroke",t=>t.fill).attr("stroke-width",.5).attr("fill","none").attr("d",t=>t.path);let M=e.select(".scaleLabelGroup").selectAll(".percentageArcLabelGroup".concat(n)).data(z).join(t=>{let e=t.append("g").attr("class","percentageArcLabelGroup".concat(n));return e.append("text").attr("class","scaleLabel"),e});M.attr("transform","translate(".concat(s,",").concat(i,")")),M.select(".scaleLabel").attr("fill",t=>"transparent"===t.fill?"white":t.fill).attr("text-anchor","middle").attr("x",28).attr("dominant-baseline","middle").attr("y",(t,e)=>C.top-m+e*S).attr("font-size","6").text(t=>"bottom"===n?"":l.format(".0f")((1-t.value)*100));let R=T.select(".prisonsGroup").selectAll(".prisonGroup".concat(n)).data(t=>{let e=t.data.data,a=(t.endAngle-t.startAngle)/(e.length+1);return e.reduce((e,r,n)=>{let l=t.startAngle+n*a+a;return e.push({data:r,lines:f(r,l,a,k)}),e},[])}).join(t=>{let e=t.append("g").attr("class","prisonGroup".concat(n));return e.append("g").attr("class","prisonLines"),e.append("path").attr("class","prisonMouseoverPath"),e});R.select(".prisonMouseoverPath").attr("d",t=>t.lines[0].linePath).attr("stroke","transparent").attr("stroke-width",10).attr("cursor","pointer").on("mousemove",(t,e)=>{L(t,"prison",[e.data],o)}).on("mouseout",()=>{b()});let I=R.select(".prisonLines").selectAll(".prisonLineGroup".concat(n)).data(t=>t.lines).join(t=>{let e=t.append("g").attr("class","prisonLineGroup".concat(n));return e.append("path").attr("class","prisonLine"),e.append("path").attr("class","policeSquare"),e.append("g").attr("class","pieArcs"),e});I.select(".prisonLine").attr("stroke",t=>t.stroke).attr("stroke-dasharray",t=>t.dashArray).attr("stroke-width",1).attr("d",t=>t.linePath),I.select(".policeSquare").attr("d",t=>t.showSquare?u().squarePath:"").attr("fill",t=>t.stroke).attr("transform",t=>"translate(".concat(t.endCoord[0],",").concat(t.endCoord[1],") rotate(").concat(t.angleAsDegrees,")")),I.select(".pieArcs").attr("transform",t=>"translate(".concat(t.endCoord[0],",").concat(t.endCoord[1],") rotate(").concat("top"===n?t.angleAsDegrees:t.angleAsDegrees-180,")"));let O=u().circularArcs,Q=l.scaleThreshold().domain([1,16,31]).range([0,1,2,3]);I.select(".pieArcs").selectAll(".policeStaffArcs".concat(n)).data(t=>O.slice(0,Q(t.data.differenceInPoliceNumbers)).reduce((e,a)=>(e.push({path:a,stroke:t.stroke}),e),[])).join(t=>{let e=t.append("g").attr("class","policeStaffArcs".concat(n));return e.append("path").attr("class","policeStaffCurve"),e}).select(".policeStaffCurve").attr("d",t=>t.path).attr("fill",t=>t.stroke)},w=t=>{let{svg:e,criticalityData:a,transformX:r,transformY:n,chartWidth:s,chartHeight:i}=t,c=a.map(t=>t.name),o=l.scaleBand().domain(c).range([0,s]),p=a.reduce((t,e)=>(e.percentChange=(e.data["2024"]-e.data["2023"])/e.data["2023"],t.push(e),t),[]),d=l.scaleLinear().domain([0,.5]).range([i-10,0]),h=e.select(".criticalityYAxis"),g=Array.from({length:51},(t,e)=>.01*e);h.call(l.axisRight(d).tickValues(g).tickSizeOuter(0)).attr("transform","translate(".concat(r+s-20,",").concat(n,")")),h.selectAll("path").style("display","none"),e.select(".criticalityYAxisLineLeft").attr("d","M4.5,-0.5L-17.5,".concat((i-10)/2,"L5,").concat(i-10)).style("stroke",v.lightGrey).attr("stroke-width",1).attr("fill","none").attr("transform","translate(".concat(r-30,",").concat(n,")")),e.select(".criticalityYAxisLineRight").attr("d","M4.5,-0.5L22.5,".concat((i-10)/2,"L5,").concat(i-10)).style("stroke",v.lightGrey).attr("stroke-width",1).attr("fill","none").attr("transform","translate(".concat(r+s-20,",").concat(n,")"));let f=t=>t>0&&Math.round(100*t)%10==0,m=(t,e)=>0===e?0:t<=.25?5+.75*e:22.5-(e-25)*.75;h.selectAll("line").attr("x2",m).attr("stroke-width",.5).attr("stroke",t=>f(t)?"white":"black"),h.selectAll("text").attr("pointer-events","none").attr("dx",(t,e)=>m(t,e)-5).attr("font-weight",300).attr("fill",v.lightGrey).attr("font-size",8).text(t=>f(t)?Math.round(100*t):"");let{squarePath:y}=u(),L=e.select(".criticalityGroup").selectAll(".criticalityElementsGroup").data(p).join(t=>{let e=t.append("g").attr("class","criticalityElementsGroup");return e.append("line").attr("class","startLine"),e.append("text").attr("class","startLineLabel"),e.append("line").attr("class","endLine"),e.append("text").attr("class","endLineLabel"),e.append("path").attr("class","percentChangeSquare"),e.append("text").attr("class","percentChangeLabel"),e.append("line").attr("class","percentChangeLine"),e.append("text").attr("class","nameLabel"),e});L.attr("transform","translate(".concat(r,",").concat(n,")")),L.select(".percentChangeSquare").attr("pointer-events","none").attr("d",y).attr("fill",t=>t.percentChange&&t.percentChange>.5?v.red:"white").attr("stroke-width",0).attr("transform",t=>"translate(".concat(o(t.name),",").concat(d(t.percentChange<=.5?t.percentChange:.8),")")),L.select(".percentChangeLine").attr("pointer-events","none").attr("x1",t=>o(t.name)||0).attr("x2",t=>o(t.name)||0).attr("y1",d(.8)).attr("y2",i-10).attr("stroke",v.red).attr("stroke-width",t=>.5*(t.percentChange>=.5)),L.select(".percentChangeLabel").attr("pointer-events","none").attr("x",t=>o(t.name)||0).attr("y",d(.8)-6).attr("fill",v.red).attr("text-anchor","middle").attr("font-size",10).attr("font-weight",600).text(t=>t.percentChange<=.5?"":"+".concat(l.format(".0%")(t.percentChange))),L.select(".nameLabel").attr("pointer-events","none").attr("transform",t=>"translate(".concat(o(t.name),",").concat(i-3,")")).attr("fill","white").attr("text-anchor","middle").attr("font-size",6).attr("font-weight",300).text(t=>t.name.toUpperCase()),e.selectAll(".nameLabel").each((t,e,a)=>{x(l.select(a[e]),45)}),L.select(".startLine").attr("pointer-events","none").attr("x1",t=>(o(t.name)||0)-10).attr("x2",t=>(o(t.name)||0)-10).attr("y1",0).attr("y2",i-10).attr("stroke","white").attr("stroke-width",.5),L.select(".startLineLabel").attr("pointer-events","none").attr("x",t=>(o(t.name)||0)-10).attr("y",-3).attr("fill","white").attr("text-anchor","middle").attr("font-size",8).attr("font-weight",300).text(t=>t.data["2023"]),L.select(".endLine").attr("pointer-events","none").attr("x1",t=>(o(t.name)||0)+10).attr("x2",t=>(o(t.name)||0)+10).attr("y1",-10).attr("y2",i-10).attr("stroke","white").attr("stroke-width",1),L.select(".endLineLabel").attr("pointer-events","none").attr("x",t=>(o(t.name)||0)+10).attr("y",-13).attr("fill","white").attr("text-anchor","middle").attr("font-size",8).attr("font-weight",600).text(t=>t.data["2024"]),e.select(".criticalityArmSvgLeft").attr("viewBox",[0,0,1500,1500]),e.select(".criticalityArmSvgLeft").selectAll("path").data(["M20,25 L20,45 L30,45 L30,30 Q30,25 25,25 Q20,25 20,30 Z","M35,25 L60,25 Q65,25 65,30 L65,30 Q65,35 60,35 L35,35 Z","M35,40 L60,40 Q65,40 65,45 L65,45 Q65,50 60,50 L35,50 Z","M35,55 L60,55 Q65,55 65,60 L65,60 Q65,65 60,65 L35,65 Z"]).join("path").attr("pointer-events","none").attr("fill",v.lightGrey).attr("d",t=>t).attr("transform","translate(".concat(r+1075,",").concat(n+626,")")),e.select(".criticalityArmSvgRight").attr("viewBox",[0,0,1500,1500]),e.select(".criticalityArmSvgRight").selectAll("path").data(["M70,25 L70,45 L80,45 L80,30 Q80,25 75,25 Q70,25 70,30 Z","M65,25 L40,25 Q35,25 35,30 L35,30 Q35,35 40,35 L65,35Z","M65,40 L40,40 Q35,40 35,45 L35,45 Q35,50 40,50 L65,50","M65,55 L40,55 Q35,55 35,60 L35,60 Q35,65 40,65 L65,65Z"]).join("path").attr("pointer-events","none").attr("fill",v.lightGrey).attr("d",t=>t).attr("transform","translate(".concat(r+240,",").concat(n+626,")"))},k=t=>{let{svg:e,prisonDeathData:a,transformX:r,transformY:n,chartWidth:s,chartHeight:i}=t,c=a.sort((t,e)=>l.ascending(t.year,e.year)).map(t=>String(t.year)),o=l.scalePoint().domain(c).range([0,s]),p=l.extent(a,t=>t.count);p[0]&&p[1]||(p=[0,0]);let d=l.scaleLinear().domain(p).range([i,0]),h=e.select(".prisonDeathXAxis");h.call(l.axisBottom(o).tickSizeOuter(0)).attr("transform","translate(".concat(r,",").concat(n,")")),h.selectAll("path").style("display","none"),h.selectAll("line").attr("display","none"),h.selectAll("text").attr("pointer-events","none").attr("font-weight",300).attr("fill",v.lightGrey).attr("y",5).attr("font-size",8);let g=l.line().x(t=>o(String(t.year))||0).y(t=>d(t.count));e.select(".prisonDeathPath").datum(a).attr("fill","none").attr("stroke",v.red).attr("stroke-width",1).attr("d",g).attr("transform","translate(".concat(r,",").concat(n-i-12.5,")"));let{squarePath:f}=u(),m=e.select(".prisonDeathGroup").selectAll(".prisonDeathLineElements").data(a).join(t=>{let e=t.append("g").attr("class","prisonDeathLineElements");return e.append("path").attr("class","chartSquare"),e.append("text").attr("class","chartLabel"),e});m.attr("transform","translate(".concat(r,",").concat(n-i-12.5,")")),m.select(".chartSquare").attr("d",f).attr("fill","white").attr("stroke-width",0).attr("transform",t=>"translate(".concat(o(String(t.year)),",").concat(d(t.count),")")),m.select(".chartLabel").attr("pointer-events","none").attr("fill","white").attr("text-anchor","middle").attr("x",t=>o(String(t.year))||0).attr("y",t=>d(t.count)-6).attr("font-size",8).text(t=>t.count)},v={background:"#24242e",darkGrey:"#484751",lightGrey:"#ababba",red:"#cc0e0e"},G=10,C={left:10,right:10,top:15,bottom:20},S=t=>{let{containerClass:e,chartData:a,regionData:s,prisonDeathData:i,criticalityData:o,suicidesPerRegion:p}=t,d=(0,n.useRef)(null);return setTimeout(()=>{l.select(".floatingDiv").style("display","none")},8e3),(0,n.useEffect)(()=>{if(!d.current)return;let t=l.select(d.current);if(!t.node())return;let r=l.select(".".concat(e,"Container")).node();if(!r)return;let{clientHeight:n}=r,h=1e3/1.4,u=1e3/1.4*.378;t.attr("viewBox",[0,0,h,1e3]).attr("width",n/1.4).attr("height",n),y(t,h,1e3);let{pieTopData:g,pieBottomData:f}=c(a,s),x=l.max(Object.values(p)),L=l.scaleSqrt().domain([1,x||0]).range([5,15]).clamp(!0),b={width:h,height:1e3,circleRadius:u};A({svg:t,dimensions:b,pieData:g,pieClass:"top",transformX:h-C.right-u,transformY:C.top+u,prisonCircleScale:L,suicidesPerRegion:p}),A({svg:t,dimensions:b,pieData:f,pieClass:"bottom",transformX:C.left+u,transformY:1e3-C.bottom-u,prisonCircleScale:L,suicidesPerRegion:p}),k({svg:t,prisonDeathData:i,transformX:.4*h+10,transformY:1e3-C.bottom-18,chartWidth:.58*h-25,chartHeight:15}),w({svg:t,criticalityData:o,transformX:.4*h+65,transformY:650,chartWidth:.58*h-65,chartHeight:256.5}),m(t.select(".legendGroup").attr("transform","translate(0,280)"),L)},[e,a,s,i,o,p]),(0,r.jsxs)("svg",{ref:d,children:[(0,r.jsx)("text",{className:"titleFont valeriaLink"}),(0,r.jsx)("text",{className:"titleFont chartTitle"}),(0,r.jsx)("text",{className:"chartInfo1"}),(0,r.jsx)("text",{className:"chartInfo2"}),(0,r.jsxs)("g",{className:"legendGroup",children:[(0,r.jsx)("text",{className:"titleFont legendTitle"}),(0,r.jsx)("g",{className:"circlesGroup"}),(0,r.jsx)("g",{className:"circleLabelsGroup"}),(0,r.jsx)("g",{className:"linesGroup"}),(0,r.jsx)("text",{className:"policeTitle"}),(0,r.jsx)("path",{className:"policeSquare"}),(0,r.jsx)("g",{className:"policePathsGroup"}),(0,r.jsx)("g",{className:"policeLinesGroup"})]}),(0,r.jsx)("g",{className:"scaleGroup"}),(0,r.jsx)("g",{className:"arcGroup"}),(0,r.jsx)("rect",{className:"scaleBackgroundRect"}),(0,r.jsx)("g",{className:"scaleLabelGroup"}),(0,r.jsx)("path",{className:"topStartRegionLine"}),(0,r.jsx)("path",{className:"bottomStartRegionLine"}),(0,r.jsx)("text",{className:"titleFont prisonDeathTitle"}),(0,r.jsx)("text",{className:"titleFont criticalitiesTitle"}),(0,r.jsx)("text",{className:"criticalitiesExtra"}),(0,r.jsx)("g",{className:"prisonDeathXAxis"}),(0,r.jsx)("path",{className:"prisonDeathPath"}),(0,r.jsx)("g",{className:"prisonDeathGroup"}),(0,r.jsx)("g",{className:"criticalityYAxis"}),(0,r.jsx)("path",{className:"criticalityYAxisLineLeft"}),(0,r.jsx)("path",{className:"criticalityYAxisLineRight"}),(0,r.jsx)("g",{className:"criticalityGroup"}),(0,r.jsx)("svg",{className:"criticalityArmSvgLeft"}),(0,r.jsx)("svg",{className:"criticalityArmSvgRight"})]})}},4987:(t,e,a)=>{Promise.resolve().then(a.bind(a,2469))}},t=>{var e=e=>t(t.s=e);t.O(0,[754,441,684,358],()=>e(4987)),_N_E=t.O()}]);